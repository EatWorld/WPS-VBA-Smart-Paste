# WPS/Excel VBA æ™ºèƒ½ç²˜è´´å·¥å…· (Smart Paste Tool)

è¿™æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨å’Œçµæ´»çš„VBAå®å·¥å…·ï¼Œæ—¨åœ¨è§£å†³ä¸€ä¸ªå¸¸è§çš„è¡¨æ ¼æ“ä½œéš¾é¢˜ï¼š**å¦‚ä½•å°†ä¸€åˆ—æ•°æ®ç²¾ç¡®åœ°ç²˜è´´åˆ°å«æœ‰å¤§é‡ä¸è§„åˆ™åˆå¹¶å•å…ƒæ ¼çš„å¦ä¸€åˆ—ä¸­**ã€‚

æ™®é€šç²˜è´´åœ¨è¿™ç§æƒ…å†µä¸‹ä¼šå¤±è´¥ï¼Œè€Œè¿™ä¸ªå·¥å…·é€šè¿‡äº¤äº’å¼å¯¹è¯æ¡†ï¼Œè®©ç”¨æˆ·é€šè¿‡é¼ æ ‡é€‰æ‹©æºå’Œç›®æ ‡ï¼Œå®ç°äº†å®Œç¾çš„â€œæ™ºèƒ½â€å¡«å……ã€‚

---

## âœ¨ åŠŸèƒ½äº®ç‚¹

- **äº¤äº’å¼æ“ä½œ**ï¼šæ— éœ€ä¿®æ”¹ä»»ä½•ä»£ç ï¼Œé€šè¿‡å¯¹è¯æ¡†å¼•å¯¼ç”¨æˆ·é€‰æ‹©æ•°æ®æºå’Œç›®æ ‡ä½ç½®ã€‚
- **é€šç”¨æ€§å¼º**ï¼šä¸é™åˆ¶å·¥ä½œè¡¨åç§°ã€æ•°æ®ä½ç½®ï¼Œé€‚ç”¨äºä»»ä½•WPSæˆ–Excelæ–‡ä»¶ã€‚
- **æ™ºèƒ½è¯†åˆ«åˆå¹¶å•å…ƒæ ¼**ï¼šè‡ªåŠ¨è®¡ç®—åˆå¹¶å•å…ƒæ ¼çš„å¤§å°ï¼Œç¡®ä¿æ•°æ®è¢«æ­£ç¡®åœ°ã€ä¸é‡ä¸æ¼åœ°å¡«å…¥æ¯ä¸ªç‹¬ç«‹çš„å•å…ƒæ ¼ï¼ˆæˆ–åˆå¹¶åŒºåŸŸï¼‰ä¸­ã€‚
- **é«˜æ•ˆç¨³å®š**ï¼šä»£ç ç»è¿‡ä¼˜åŒ–ï¼Œèƒ½å¤Ÿå¿«é€Ÿå¤„ç†å¤§é‡æ•°æ®ã€‚

---

## ğŸš€ å¦‚ä½•ä½¿ç”¨

æ•´ä¸ªè¿‡ç¨‹éå¸¸ç®€å•ï¼Œåªéœ€è¦ä¸‰æ­¥ï¼š

1.  **å¯¼å…¥ä»£ç **ï¼š
    - åœ¨WPSæˆ–Excelä¸­ï¼ŒæŒ‰ `Alt + F11` æ‰“å¼€VBAç¼–è¾‘å™¨ã€‚
    - åœ¨èœå•æ ç‚¹å‡» `æ’å…¥` -> `æ¨¡å—`ã€‚
    - å°†ä¸‹é¢çš„VBAä»£ç å®Œæ•´å¤åˆ¶å¹¶ç²˜è´´åˆ°æ–°æ¨¡å—çš„ç©ºç™½åŒºåŸŸä¸­ã€‚
    - å…³é—­VBAç¼–è¾‘å™¨ã€‚

2.  **è¿è¡Œå®**ï¼š
    - å›åˆ°è¡¨æ ¼ç•Œé¢ï¼ŒæŒ‰ `Alt + F8` æ‰“å¼€å®åˆ—è¡¨ã€‚
    - é€‰æ‹©åä¸º `InteractiveSmartPaste` çš„å®ï¼Œç‚¹å‡» `è¿è¡Œ`ã€‚

3.  **æ ¹æ®æç¤ºæ“ä½œ**ï¼š
    - **ç¬¬1æ­¥**ï¼šä¼šå¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†ï¼Œè¦æ±‚æ‚¨ **é€‰æ‹©æºæ•°æ®**ã€‚æ­¤æ—¶ï¼Œç”¨é¼ æ ‡æ¡†é€‰æ‚¨è¦å¤åˆ¶çš„é‚£ä¸€åˆ—æ•°æ®ï¼Œç„¶åç‚¹å‡»â€œç¡®å®šâ€ã€‚
    - **ç¬¬2æ­¥**ï¼šä¼šå¼¹å‡ºç¬¬äºŒä¸ªæç¤ºæ¡†ï¼Œè¦æ±‚æ‚¨ **é€‰æ‹©ç²˜è´´ä½ç½®**ã€‚æ­¤æ—¶ï¼Œç”¨é¼ æ ‡ **å•å‡»** æ‚¨å¸Œæœ›æ•°æ®å¼€å§‹å¡«å……çš„ç¬¬ä¸€ä¸ªå•å…ƒæ ¼ï¼Œç„¶åç‚¹å‡»â€œç¡®å®šâ€ã€‚

å®Œæˆï¼ç¨‹åºä¼šè‡ªåŠ¨å°†æ‰€æœ‰æ•°æ®å¡«å……åˆ°ç›®æ ‡ä½ç½®ã€‚

---

## ğŸ“‹ VBA æºä»£ç 

è¿™æ˜¯æ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨çš„VBAä»£ç ã€‚æ‚¨ä¹Ÿå¯ä»¥å°†æ­¤é¡¹ç›®ä¸­çš„ `SmartPaste.bas` æ–‡ä»¶é€šè¿‡VBAç¼–è¾‘å™¨çš„ `æ–‡ä»¶` -> `å¯¼å…¥æ–‡ä»¶` åŠŸèƒ½ç›´æ¥å¯¼å…¥åˆ°æ‚¨çš„é¡¹ç›®ä¸­ã€‚

```vba
Sub InteractiveSmartPaste()
    Dim sourceRange As Range
    Dim targetStartCell As Range
    Dim sourceData As Variant
    Dim targetSheet As Worksheet
    Dim currentTargetCell As Range
    Dim dataIndex As Long
    
    ' --- Step 1: è®©ç”¨æˆ·ç”¨é¼ æ ‡é€‰æ‹©æºæ•°æ® ---
    On Error Resume Next ' å¦‚æœç”¨æˆ·ç‚¹äº†â€œå–æ¶ˆâ€ï¼Œå¯ä»¥é¿å…ç¨‹åºæŠ¥é”™
    Set sourceRange = Application.InputBox("è¯·ç”¨é¼ æ ‡é€‰æ‹©æ‚¨è¦å¤åˆ¶çš„æºæ•°æ®åˆ—ã€‚", "ç¬¬1æ­¥ï¼šé€‰æ‹©æºæ•°æ®", Type:=8)
    On Error GoTo 0 ' æ¢å¤æ­£å¸¸çš„é”™è¯¯å¤„ç†
    
    ' æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å–æ¶ˆäº†é€‰æ‹©
    If sourceRange Is Nothing Then
        MsgBox "æ“ä½œå·²å–æ¶ˆã€‚", vbInformation
        Exit Sub
    End If
    
    ' --- Step 2: è®©ç”¨æˆ·ç”¨é¼ æ ‡é€‰æ‹©ç²˜è´´çš„èµ·å§‹ä½ç½® ---
    On Error Resume Next
    Set targetStartCell = Application.InputBox("è¯·ç”¨é¼ æ ‡ç‚¹å‡»æ‚¨è¦ç²˜è´´åˆ°çš„ç¬¬ä¸€ä¸ªå•å…ƒæ ¼ã€‚", "ç¬¬2æ­¥ï¼šé€‰æ‹©ç²˜è´´ä½ç½®", Type:=8)
    On Error GoTo 0
    
    ' æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å–æ¶ˆäº†é€‰æ‹©
    If targetStartCell Is Nothing Then
        MsgBox "æ“ä½œå·²å–æ¶ˆã€‚", vbInformation
        Exit Sub
    End If
    
    ' --- Step 3: å¼€å§‹å¤„ç†æ•°æ® ---
    
    ' ä¸ºäº†é˜²æ­¢ç”¨æˆ·é€‰æ‹©å¤šä¸ªå•å…ƒæ ¼ï¼Œæˆ‘ä»¬åªå–ä»–é€‰æ‹©åŒºåŸŸçš„ç¬¬ä¸€ä¸ªå•å…ƒæ ¼ä½œä¸ºèµ·ç‚¹
    Set targetStartCell = targetStartCell.Cells(1, 1)
    Set targetSheet = targetStartCell.Worksheet
    
    ' å°†æºæ•°æ®ä¸€æ¬¡æ€§è¯»å…¥æ•°ç»„ï¼Œæé«˜é€Ÿåº¦
    sourceData = sourceRange.Value
    
    ' å¦‚æœæºæ•°æ®æ˜¯ç©ºçš„ï¼Œåˆ™æç¤ºå¹¶é€€å‡º
    If IsEmpty(sourceData) Then
        MsgBox "æ‚¨é€‰æ‹©çš„æºæ•°æ®åŒºåŸŸæ˜¯ç©ºçš„ï¼Œæ²¡æœ‰å†…å®¹å¯ä»¥ç²˜è´´ã€‚", vbExclamation
        Exit Sub
    End If

    dataIndex = 1 ' æ•°æ®ç´¢å¼•ï¼Œä»1å¼€å§‹
    Set currentTargetCell = targetStartCell ' å½“å‰è¦ç²˜è´´çš„ç›®æ ‡å•å…ƒæ ¼
    
    ' å¾ªç¯å¤„ç†ï¼Œç›´åˆ°æ‰€æœ‰æºæ•°æ®éƒ½ç²˜è´´å®Œæ¯•
    Do While dataIndex <= UBound(sourceData, 1)
        
        ' å°†æ•°æ®ç²˜è´´åˆ°å½“å‰ç›®æ ‡å•å…ƒæ ¼
        currentTargetCell.Value = sourceData(dataIndex, 1)
        
        ' å‡†å¤‡å¤„ç†ä¸‹ä¸€æ¡æ•°æ®
        dataIndex = dataIndex + 1
        
        ' å¦‚æœæ•°æ®å·²ç»ç”¨å®Œï¼Œå°±è·³å‡ºå¾ªç¯
        If dataIndex > UBound(sourceData, 1) Then Exit Do
        
        ' å…³é”®ä¸€æ­¥ï¼šè®¡ç®—ä¸‹ä¸€ä¸ªå¯ç”¨çš„ç²˜è´´ä½ç½®
        ' å®ƒä¼šè·³è¿‡å½“å‰å•å…ƒæ ¼æ‰€å ç”¨çš„æ‰€æœ‰åˆå¹¶åŒºåŸŸ
        Set currentTargetCell = targetSheet.Cells(currentTargetCell.MergeArea.Row + currentTargetCell.MergeArea.Rows.Count, currentTargetCell.Column)
        
    Loop
    
    MsgBox "å¤ªæ£’äº†ï¼" & (dataIndex - 1) & " æ¡æ•°æ®å·²æˆåŠŸå¡«å……ï¼"
End Sub
```
